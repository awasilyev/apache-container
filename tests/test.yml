---
- name: Test apache service   
  hosts: localhost
  connection: local
  gather_facts: no
  vars:
    host_ip: 127.0.0.1
  tasks:
    - name: Wait for service to be available
      wait_for:
        host: "{{ host_ip }}"
        port: 80
        delay: 5
        timeout: 120 

    - name: Query the home page
        uri:
          url: "http://{{ host_ip }}:80" 
          return_content: yes
        register: output

      - name: Show output
        debug:
          var: output

      - name: Should see server name 
        assert:
          that: "'apache' in output.content"
